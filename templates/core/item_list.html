{% extends 'core/base.html' %}

{% block title %}–í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã | Lost & Found{% endblock %}

{% block content %}
<div class="items-table-container">
    <h1>üìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤</h1>
    <p style="color: #666; margin-bottom: 2rem;">–í—Å–µ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –±–∞–∑–µ: {{ page_obj.paginator.count }}</p>

    <div class="filters">
        <a href="?status=all" class="filter-btn {% if status_filter == 'all' %}active{% endif %}">–í—Å–µ ({{ page_obj.paginator.count }})</a>
        <a href="?status=found" class="filter-btn {% if status_filter == 'found' %}active{% endif %}">–ù–∞–π–¥–µ–Ω–æ ({{ found_count }})</a>
        <a href="?status=lost" class="filter-btn {% if status_filter == 'lost' %}active{% endif %}">–ü–æ—Ç–µ—Ä—è–Ω–æ ({{ lost_count }})</a>
    </div>

    {% if items %}
        <div style="overflow-x: auto;">
            <table class="items-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–∞—Ç–∞</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr class="{% if item.found %}found-row{% else %}lost-row{% endif %}">
                        <td><strong>#{{ item.id }}</strong></td>
                        <td><strong>{{ item.title }}</strong></td>
                        <td>{{ item.description|truncatechars:80 }}</td>
                        <td>
                            {% if item.found %}
                                <span class="badge found">‚úÖ –ù–∞–π–¥–µ–Ω–æ</span>
                            {% else %}
                                <span class="badge lost">‚ùå –ü–æ—Ç–µ—Ä—è–Ω–æ</span>
                            {% endif %}
                        </td>
                        <td>{{ item.created_at|date:"d.m.Y H:i" }}</td>
                        <td>
                            <div class="action-buttons">
                                <a href="{% url 'item_detail' item.id %}" class="btn-api">üëÅÔ∏è</a>
                                <a href="{% url 'api-item-detail' item.id %}" class="btn-api" target="_blank">üîó API</a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        {% if is_paginated %}
        <div class="pagination">
            {% if page_obj.has_previous %}
                <a href="?page=1&status={{ status_filter }}">¬´ –ü–µ—Ä–≤–∞—è</a>
                <a href="?page={{ page_obj.previous_page_number }}&status={{ status_filter }}">‚Äπ –ù–∞–∑–∞–¥</a>
            {% endif %}
            
            <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}</span>
            
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}&status={{ status_filter }}">–í–ø–µ—Ä–µ–¥ ‚Ä∫</a>
                <a href="?page={{ page_obj.paginator.num_pages }}&status={{ status_filter }}">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</a>
            {% endif %}
        </div>
        {% endif %}
        
        <div style="margin-top: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
            <p><strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏:</p>
            <code style="display: block; background: #2c3e50; color: white; padding: 0.5rem; border-radius: 4px; margin-top: 0.5rem;">
                curl -X GET http://localhost:8000/api/items/
            </code>
        </div>
    {% else %}
        <div class="no-items">
            <p style="font-size: 1.2rem; margin-bottom: 1rem;">üì≠ –ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.</p>
            <a href="/admin/core/item/add/" class="btn-api">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç</a>
            <p style="margin-top: 1rem; color: #666;">–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ API –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</p>
            <code style="display: block; background: #f8f9fa; padding: 1rem; border-radius: 4px; margin-top: 0.5rem; font-family: monospace;">
                curl -X POST http://localhost:8000/api/items/ \<br>
                -H "Content-Type: application/json" \<br>
                -d '{"title": "–ü—Ä–∏–º–µ—Ä", "description": "–û–ø–∏—Å–∞–Ω–∏–µ", "found": false}'
            </code>
        </div>
    {% endif %}
</div>
{% endblock %}